const units = {
    727: [
      // 727
      {
        word: "species",
        meaning: "（生物分類上の）種",
        sentence: "Elephants and other endangered ( ).",
        jp: "ゾウなどの絶滅危惧種"
      },
  
      // 728
      {
        word: "pesticides",
        meaning: "（虫や小動物などの）殺虫剤、除草剤",
        sentence: "Spray crops with ( ).",
        jp: "作物に農薬を散布する"
      },
  
      // 729
      {
        word: "extinct",
        meaning: "絶滅した",
        sentence: "Dinosaurs became ( ) millions of years ago.",
        jp: "恐竜は何百万年も前に絶滅した。"
      },
  
      // 730 feed
      {
        word: "feed",
        meaning: "〜にえさを与える",
        sentence: "( ) these goldfish.",
        jp: "これらの金魚にえさを与える"
      },
      {
        word: "feed",
        meaning: "（人・家族など）を養う",
        sentence: "( ) a family of five.",
        jp: "5人家族を養う"
      },
      {
        word: "feed",
        meaning: "（on ～）（～を）常食とする",
        sentence: "Sheep ( ) on grass.",
        jp: "ヒツジは草を常食とする"
      },
  
      // 731
      {
        word: "energetic",
        meaning: "活発な",
        sentence: "( ) boys and girls",
        jp: "活発な少年少女たち"
      },
  
      // 732
      {
        word: "greedy",
        meaning: "貪欲な",
        sentence: "A ( ) child ate all the pies.",
        jp: "食い意地の張った子がパイを全部食べた。"
      },
  
      // 733
      {
        word: "brave",
        meaning: "勇敢な",
        sentence: "A ( ) firefighter",
        jp: "勇敢な消防士"
      },
  
      // 734
      {
        word: "generous",
        meaning: "寛大な、気前のよい",
        sentence: "Leave a ( ) tip.",
        jp: "気前よくチップを置く"
      },
  
      // 735
      {
        word: "intellectual",
        meaning: "知的な",
        sentence: "( ) property",
        jp: "知的財産"
      },
  
      // 736 curious
      {
        word: "curious",
        meaning: "好奇心が強い",
        sentence: "Babies are ( ) about everything.",
        jp: "赤ん坊はすべての物に対して好奇心が強い。"
      },
      {
        word: "curious",
        meaning: "奇妙な、好奇心をそそる",
        sentence: "It is ( ) that we haven't heard from her for days.",
        jp: "彼女から何日も連絡がないのは奇妙だ。"
      },
  
      // 737
      {
        word: "imaginative",
        meaning: "想像力豊かな",
        sentence: "Children are very ( ).",
        jp: "子どもは非常に想像力が豊かだ。"
      },
  
      // 738 afford
      {
        word: "afford",
        meaning: "（can ～）〜する余裕がある",
        sentence: "I can't ( ) to buy a new car.",
        jp: "新車を買う余裕がない。"
      },
      {
        word: "afford",
        meaning: "（人）に（物・事）を与える",
        sentence: "Music ( )s me great pleasure.",
        jp: "音楽は私に大きな喜びを与えてくれる。"
      },
  
      // 739
      {
        word: "eager",
        meaning: "熱心な",
        sentence: "She is ( ) to buy a fur coat.",
        jp: "彼女は毛皮のコートを買いたがっている。"
      },
  
      // 740
      {
        word: "selfish",
        meaning: "利己的な、自分勝手な",
        sentence: "Don't be ( )!",
        jp: "自分勝手なことをしてはだめだよ。"
      },
  
      // 741 aggressive
      {
        word: "aggressive",
        meaning: "攻撃的な",
        sentence: "Her attitude suddenly became ( ).",
        jp: "彼女の態度が突然攻撃的になった。"
      },
      {
        word: "aggressive",
        meaning: "積極的な",
        sentence: "A successful businessperson needs to be ( ).",
        jp: "ビジネスで成功するには積極的でないといけない。"
      },
  
      // 742
      {
        word: "cruel",
        meaning: "残酷な",
        sentence: "Never be ( ) to animals.",
        jp: "動物を残酷に扱うな。"
      },
  
      // 743
      {
        word: "addicted",
        meaning: "～の中毒になっている",
        sentence: "Lucy is ( ) to her smartphone.",
        jp: "ルーシーはスマホ中毒である。"
      },
  
      // 744
      {
        word: "stubborn",
        meaning: "頑固な",
        sentence: "A ( ) old man",
        jp: "頑固な老人"
      },
  
      // 745
      {
        word: "bold",
        meaning: "大胆な",
        sentence: "A dress with a ( ) design",
        jp: "大胆なデザインの服"
      },
  
      // 746 guilty
      {
        word: "guilty",
        meaning: "申し訳なく思う、罪の意識がある",
        sentence: "I feel ( ) about lying to her.",
        jp: "彼女にうそをついたことを申し訳なく思う。"
      },
      {
        word: "guilty",
        meaning: "（of ～）罪を犯した",
        sentence: "He was ( ) of cheating at cards.",
        jp: "彼はいかさまをした。"
      },
  
      // 747 innocent
      {
        word: "innocent",
        meaning: "（of ～）無実の",
        sentence: "He is ( ) of the crime.",
        jp: "彼はその犯罪に関して無実だ。"
      },
      {
        word: "innocent",
        meaning: "無邪気な",
        sentence: "An ( ) girl",
        jp: "無邪気な少女"
      },
  
      // 748 sincere
      {
        word: "sincere",
        meaning: "誠実な",
        sentence: "Make a ( ) effort.",
        jp: "誠実な努力をする"
      },
      {
        word: "sincere",
        meaning: "心からの",
        sentence: "Express my ( ) thanks.",
        jp: "心からの感謝を表現する"
      },
  
      // 749 modest
      {
        word: "modest",
        meaning: "（人が）謙虚な",
        sentence: "He is ( ) about his success.",
        jp: "彼は成功を鼻にかけない。"
      },
      {
        word: "modest",
        meaning: "（物が）質素な",
        sentence: "A ( ) house with a small garden",
        jp: "小さな庭つきの質素な家"
      },
  
      // 750
      {
        word: "stupid",
        meaning: "ばかな",
        sentence: "Make a ( ) mistake.",
        jp: "ばかな間違いをする"
      },
  
      // 751
      {
        word: "indifferent",
        meaning: "無関心な",
        sentence: "He is ( ) to politics.",
        jp: "彼は政治に無関心だ。"
      },
  
      // 752
      {
        word: "punctual",
        meaning: "時間を守る",
        sentence: "Japanese trains are extremely ( ).",
        jp: "日本の列車は非常に時間に正確だ。"
      },
  
      // 753
      {
        word: "coward",
        meaning: "臆病者",
        sentence: "He is a ( ) when it comes to dentists.",
        jp: "彼は歯医者に関しては臆病者だ。"
      },
  
      // 754
      {
        word: "precise",
        meaning: "正確な、精密な",
        sentence: "Each plane follows a ( ) route.",
        jp: "各飛行機は正確な航路をたどる。"
      },
  
      // 755
      {
        word: "accurate",
        meaning: "正確な",
        sentence: "An ( ) map",
        jp: "正確な地図"
      },
  
      // 756
      {
        word: "proper",
        meaning: "適切な",
        sentence: "The ( ) use of chopsticks",
        jp: "箸の正しい使い方"
      },
  
      // 757 tidy
      {
        word: "tidy",
        meaning: "整然とした",
        sentence: "Keep the office ( ).",
        jp: "事務所をきちんとしておく"
      },
      {
        word: "tidy",
        meaning: "整頓する",
        sentence: "( ) your room.",
        jp: "部屋を整頓しなさい。"
      },
  
      // 758 efficient
      {
        word: "efficient",
        meaning: "能率的な",
        sentence: "An ( ) method of transporting goods",
        jp: "商品を輸送する能率的な方法"
      },
      {
        word: "efficient",
        meaning: "有能な",
        sentence: "An ( ) accountant",
        jp: "有能な会計士"
      },
  
      // 759 reasonable
      {
        word: "reasonable",
        meaning: "理にかなった",
        sentence: "What you're saying is ( ).",
        jp: "あなたの言っていることはもっともだ。"
      },
      {
        word: "reasonable",
        meaning: "手ごろな",
        sentence: "At a ( ) price",
        jp: "手ごろな値段で"
      },
  
      // 760 significant
      {
        word: "significant",
        meaning: "重要な、有意義な",
        sentence: "A historically ( ) event",
        jp: "歴史的に重要な出来事"
      },
      {
        word: "significant",
        meaning: "かなりの",
        sentence: "A ( ) increase in sales",
        jp: "売り上げのかなりの増加"
      },
  
      // 761 precious
      {
        word: "precious",
        meaning: "貴重な",
        sentence: "Don't waste your ( ) time.",
        jp: "貴重な時間を浪費するな。"
      },
      {
        word: "precious",
        meaning: "高価な",
        sentence: "( ) metals",
        jp: "貴金属"
      },
  
      // 762 essential
      {
        word: "essential",
        meaning: "不可欠な",
        sentence: "Water is ( ) to living things.",
        jp: "水は生物にとって不可欠だ。"
      },
      {
        word: "essential",
        meaning: "最も重要な、本質的な",
        sentence: "The bare ( )s",
        jp: "最低限必要なもの"
      }
    ]
  };  
  
  
  // ====== 状態 ======
  let currentUnit = [];
  let currentIndex = 0;
  let wrongWords = [];
  let isRandom = false;
  
  // ====== DOM ======
  const home = document.getElementById("home");
  const quiz = document.getElementById("quiz");
  const resultScreen = document.getElementById("resultScreen");
  
  const sentenceEl = document.getElementById("sentence");
  const jpEl = document.getElementById("jp");
  const input = document.getElementById("answerInput");
  const resultEl = document.getElementById("result");
  const progress = document.getElementById("progress");
  
  const judgeBtn = document.getElementById("judgeBtn");
  const nextBtn = document.getElementById("nextBtn");
  const speakBtn = document.getElementById("speakBtn");
  const reviewBtn = document.getElementById("reviewBtn");
  const meaningEl = document.getElementById("meaning");


  
  // ====== Unit一覧生成 ======
  const unitList = document.getElementById("unitList");
  Object.keys(units).forEach(key => {
    const btn = document.createElement("button");
    btn.textContent = key.toUpperCase();
    btn.className = "unit-btn";
    btn.onclick = () => startUnit(key);
    unitList.appendChild(btn);
  });
  
  // ====== 設定 ======
  document.getElementById("randomToggle").onchange = e => {
    isRandom = e.target.checked;
  };
  
  const homeBtn = document.getElementById("homeBtn");

  homeBtn.style.display = "none";

homeBtn.onclick = () => {
  if (confirm("Unitを中断してホームに戻りますか？")) {
    quiz.classList.add("hidden");
    resultScreen.classList.add("hidden");
    home.classList.remove("hidden");

    currentUnit = [];
    currentIndex = 0;
    wrongWords = [];

    homeBtn.style.display = "none";
  }
};
  
  // ====== 開始 ======
  function startUnit(key) {
    currentUnit = [...units[key]];
    if (isRandom) shuffle(currentUnit);
  
    currentIndex = 0;
    wrongWords = [];
  
    home.classList.add("hidden");
    quiz.classList.remove("hidden");
  
    homeBtn.style.display = "block";

    showCard();
  }

  // ====== 表示 ======
  function showCard() {
    const q = currentUnit[currentIndex];
  
    sentenceEl.textContent = q.sentence;
    jpEl.textContent = q.jp;
  
    input.value = "";
    input.disabled = false;
  
    resultEl.textContent = "";
    resultEl.className = "";
  
    meaningEl.textContent = "";
    meaningEl.classList.add("hidden");
  
    nextBtn.classList.add("hidden");
    speakBtn.classList.add("hidden");
  
    progress.textContent = `${currentIndex + 1} / ${currentUnit.length}`;
    input.focus();
  }
  
  // ====== 判定 ======
  function judge() {
    if (input.disabled) return;
  
    const q = currentUnit[currentIndex];
    const user = input.value.trim().toLowerCase();
  
    input.disabled = true;
  
    // 意味表示
    meaningEl.textContent = `意味：${q.meaning}`;
    meaningEl.classList.remove("hidden");
  
    if (user === q.word.toLowerCase()) {
      resultEl.textContent = "⭕ 正解";
      resultEl.classList.add("correct");
  
      // ★ ここを speakWord に変更
      speakWord(q.word);
  
      setTimeout(next, 1000);
    } else {
      resultEl.textContent = `❌ 不正解：${q.word}`;
      resultEl.classList.add("wrong");
      wrongWords.push(q);
  
      speakBtn.classList.remove("hidden");
      nextBtn.classList.remove("hidden");
    }
  }
  // ====== 次 ======
  function next() {
    currentIndex++;
    if (currentIndex >= currentUnit.length) {
      endUnit();
    } else {
      showCard();
    }
  }
  
  // ====== 終了 ======
  function endUnit() {
    quiz.classList.add("hidden");
    resultScreen.classList.remove("hidden");

    homeBtn.style.display = "none";
  
    if (wrongWords.length > 0) {
      reviewBtn.classList.remove("hidden");
    } else {
      reviewBtn.classList.add("hidden");
    }
  }
  
  // ====== 復習 ======
  reviewBtn.onclick = () => {
    currentUnit = [...wrongWords];
    wrongWords = [];
    currentIndex = 0;
  
    resultScreen.classList.add("hidden");
    quiz.classList.remove("hidden");

    homeBtn.style.display = "block";

    showCard();
  };
  
  // ====== ホーム ======
  document.getElementById("backHome").onclick = () => {
    resultScreen.classList.add("hidden");
    home.classList.remove("hidden");
  };
  
// ====== 発音（スマホ対応） ======
function speakWord(word) {
  const utter = new SpeechSynthesisUtterance(word);
  utter.lang = 'en-US';
  utter.rate = 1.0; // 速さ
  utter.pitch = 1.2;  // 音程

  // 声を取得（iOS / Android対応）
  const voices = speechSynthesis.getVoices();
  let voice = voices.find(v => v.lang === 'en-US' && v.name.includes('Google'));
  if (!voice && voices.length > 0) voice = voices[0]; // もしGoogle声がなければ最初の声
  if (voice) utter.voice = voice;

  speechSynthesis.speak(utter);
}

// iOSで最初に声が取得できない問題対策
window.speechSynthesis.onvoiceschanged = () => {
  speechSynthesis.getVoices();
};
  
speakBtn.onclick = () => {
  speakWord(currentUnit[currentIndex].word);
};
  
  // ====== イベント ======
  judgeBtn.onclick = judge;
  nextBtn.onclick = next;
  
  input.addEventListener("keydown", e => {
    if (e.key === "Enter" && !input.disabled) judge();
  });
  
  // ====== シャッフル ======
  function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }
  function login() {
    const password = document.getElementById("pw").value;
    const correctPassword = "taFumo39"; // 好きなパスワード
  
    if (password === correctPassword) {
      document.getElementById("login").style.display = "none";
      document.getElementById("app").style.display = "block";
    } else {
      alert("パスワードが違います");
    }
  }
  
  